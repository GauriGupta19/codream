configs.iid_clients
configs.iid_clients
configs.iid_clients
configs.iid_clients
configs.iid_clients
avgkd
avgkd
exp path: ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4
Experiment in ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4 already present
Press e to exit, r to replace it: avgkd
avgkd
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
['./__pycache__/', './.ipynb_checkpoints/', './imgs/', './expt_dump_old/', './expt_dump/', './expt_dump/svhn/iid/'] ['./utils/', './expt_dump/', './__pycache__/', './imgs/', './models/', './algos/', './configs/']
source code copied to exp_dump
avgkd
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Model resnet18 loading on device cuda:3
Model resnet18 loading on device cuda:1
Model resnet18 loading on device cuda:0
Model resnet18 loading on device cuda:2
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Model resnet18 loaded on device cuda:1
Model resnet18 loaded on device cuda:3
Model resnet18 loaded on device cuda:0
Model resnet18 loaded on device cuda:2
Model resnet18 loading on device cuda:0
Model resnet18 loaded on device cuda:0
Client 4 finished training with loss (14.410450220108032, 0.121)
Client 2 finished training with loss (18.15471839904785, 0.144)
Client 1 finished training with loss (17.921231031417847, 0.129)
Client 3 finished training with loss (19.56849956512451, 0.119)
Client 4 finished training with loss (14.455769777297974, 0.105)
Client 2 finished training with loss (20.76415181159973, 0.097)
Client 1 finished training with loss (15.32374119758606, 0.078)
Client 3 finished training with loss (23.643513202667236, 0.082)
Client 4 finished training with loss (14.34998607635498, 0.133)
Client 2 finished training with loss (13.30013108253479, 0.157)
Client 3 finished training with loss (16.053853273391724, 0.108)
Client 1 finished training with loss (11.357711553573608, 0.161)
Client 4 finished training with loss (12.43555498123169, 0.097)
Client 2 finished training with loss (10.844181299209595, 0.126)
Client 3 finished training with loss (11.253260374069214, 0.201)
Client 1 finished training with loss (10.819386005401611, 0.168)
Client 4 finished training with loss (9.944820642471313, 0.166)
Client 2 finished training with loss (9.523127555847168, 0.168)
Client 3 finished training with loss (10.776029825210571, 0.153)
Client 1 finished training with loss (10.468950033187866, 0.105)
1 44750336
client_node_1 1
2 44750336
3 91335680
client_node_2 2
4 91335680
5 91335680
6 94481408
7 94481408
8 94491648
9 94491648
5 91345920
6 94491648
7 94491648
8 94501888
9 94501888
5 91356160
6 94501888
7 94501888
8 94512128
9 94512128
5 91366400
6 94217216
7 94217216
8 94226944
9 94226944
client_node_2 3
4 94226944
5 91376128
6 94521856
7 94521856
8 94532096
9 94532096
5 91386368
6 94532096
7 94532096
8 94542336
9 94542336
5 91396608
6 94542336
7 94542336
8 94552576
9 94552576
5 91406848
6 94257664
7 94257664
8 94267392
9 94267392
client_node_2 4
4 94267392
5 91416576
6 94562304
7 94562304
8 94572544
9 94572544
5 91426816
6 94572544
7 94572544
8 94582784
9 94582784
5 91437056
6 94582784
7 94582784
8 94593024
9 94593024
5 91447296
6 94298112
7 94298112
8 94307840
9 94307840
1 94307840
client_node_1 2
2 94196224
3 139864064
client_node_2 1
4 139864064
5 137013248
6 140158976
7 140158976
8 140159488
9 140159488
5 137013760
6 140159488
7 140159488
8 140169728
9 140169728
5 137024000
6 140169728
7 140169728
8 140179968
9 140179968
5 137034240
6 139885056
7 139885056
8 139894784
9 139894784
client_node_2 3
4 139894784
5 137043968
6 140189696
7 140189696
8 140199936
9 140199936
5 137054208
6 140199936
7 140199936
8 140210176
9 140210176
5 137064448
6 140210176
7 140210176
8 140220416
9 140220416
5 137074688
6 139925504
7 139925504
8 139935232
9 139935232
client_node_2 4
4 139935232
5 137084416
6 140230144
7 140230144
8 140240384
9 140240384
5 137094656
6 140240384
7 140240384
8 140250624
9 140250624
5 137104896
6 140250624
7 140250624
8 140260864
9 140260864
5 137115136
6 139965952
7 139965952
8 139975680
9 139975680
1 139975680
client_node_1 3
2 139864064
3 185040384
client_node_2 1
4 185040384
5 182189568
6 185335296
7 185335296
8 185335808
9 185335808
5 182190080
6 185335808
7 185335808
8 185346048
9 185346048
5 182200320
6 185346048
7 185346048
8 185356288
9 185356288
5 182210560
6 185061376
7 185061376
8 185071104
9 185071104
client_node_2 2
4 185071104
5 182220288
6 185366016
7 185366016
8 185376256
9 185376256
5 182230528
6 185376256
7 185376256
8 185386496
9 185386496
5 182240768
6 185386496
7 185386496
8 185396736
9 185396736
5 182251008
6 185101824
7 185101824
8 185111552
9 185111552
client_node_2 4
4 185111552
5 182260736
6 185406464
7 185406464
8 185416704
9 185416704
5 182270976
6 185416704
7 185416704
8 185426944
9 185426944
5 182281216
6 185426944
7 185426944
8 185437184
9 185437184
5 182291456
6 185142272
7 185142272
8 185152000
9 185152000
1 185152000
client_node_1 4
2 185040384
3 231756800
client_node_2 1
4 231756800
5 228905984
6 232051712
7 232051712
8 232052224
9 232052224
5 228906496
6 232052224
7 232052224
8 232062464
9 232062464
5 228916736
6 232062464
7 232062464
8 232072704
9 232072704
5 228926976
6 231777792
7 231777792
8 231787520
9 231787520
client_node_2 2
4 231787520
5 228936704
6 232082432
7 232082432
8 232092672
9 232092672
5 228946944
6 232092672
7 232092672
8 232102912
9 232102912
5 228957184
6 232102912
7 232102912
8 232113152
9 232113152
5 228967424
6 231818240
7 231818240
8 231827968
9 231827968
client_node_2 3
4 231827968
5 228977152
6 232122880
7 232122880
8 232133120
9 232133120
5 228987392
6 232133120
7 232133120
8 232143360
9 232143360
5 228997632
6 232143360
7 232143360
8 232153600
9 232153600
5 229007872
6 231858688
7 231858688
8 231868416
9 231868416
defaultdict(<class 'list'>, {1: [tensor([[0, 0, 0,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]]), tensor([[-2.6861e+00,  1.0949e+01,  1.6115e+00,  ..., -8.3716e+00,
         -1.3368e+00, -8.9566e-01],
        [-8.9957e-01,  2.5200e+00,  1.4855e-01,  ..., -1.4939e+00,
         -5.4766e-01, -6.3443e-02],
        [-7.5155e+00,  2.2867e+01,  4.6283e+00,  ..., -2.8424e+01,
         -5.6404e+00, -3.0305e+00],
        ...,
        [-1.4978e+00,  3.0504e+00, -1.0021e-01,  ..., -2.5255e+00,
         -8.5850e-01,  2.7118e-02],
        [-1.8576e+00,  6.5118e+00,  3.5199e-01,  ..., -4.1587e+00,
         -7.4350e-01, -2.2698e-01],
        [-1.1151e+00,  1.9542e+00, -3.4824e-01,  ..., -7.5940e-01,
         -5.4748e-01,  5.6750e-02]], device='cuda:0'), tensor([[ -2.1058,   4.0791,  -0.2475,  ...,  -3.2567,  -0.9816,   0.0375],
        [ -2.9837,   7.0078,   0.4926,  ...,  -7.4224,  -1.7499,  -0.4226],
        [ -2.4030,   6.4390,   0.8952,  ...,  -7.2697,  -1.7497,  -0.6228],
        ...,
        [ -0.7322,   1.6073,  -0.1303,  ...,  -0.5192,  -0.6292,  -0.0591],
        [ -5.5508,  18.0676,   4.1384,  ..., -22.8104,  -4.4973,  -2.6311],
        [ -5.5566,  16.9835,   3.4939,  ..., -21.0578,  -4.2464,  -2.1850]],
       device='cuda:0'), tensor([[-0.9319,  2.5665,  0.0121,  ..., -1.4014, -0.6328, -0.0220],
        [-1.0087,  2.6608, -0.0153,  ..., -1.3893, -0.4937,  0.0130],
        [-0.8449,  1.7948, -0.1467,  ..., -0.6713, -0.6050,  0.0376],
        ...,
        [-0.6252,  1.4198, -0.0434,  ..., -0.6090, -0.6325, -0.0356],
        [-1.9692,  6.0258,  1.4605,  ..., -7.3459, -1.4851, -0.9346],
        [-2.5305,  7.1887,  1.3273,  ..., -8.5098, -1.8567, -0.9399]],
       device='cuda:0'), tensor([[-1.0191e+00,  2.7834e+00,  9.3267e-03,  ..., -1.4497e+00,
         -5.2576e-01, -4.6666e-02],
        [-1.3931e+00,  5.4404e+00,  1.8470e+00,  ..., -7.1180e+00,
         -1.3280e+00, -9.9593e-01],
        [-8.8242e-01,  1.8556e+00, -2.4875e-01,  ..., -5.3305e-01,
         -5.4817e-01,  2.1851e-02],
        ...,
        [-2.3823e+00,  8.3826e+00,  2.4501e+00,  ..., -1.0852e+01,
         -2.0409e+00, -1.4507e+00],
        [-8.1857e-01,  1.7963e+00, -2.3404e-02,  ..., -8.9626e-01,
         -6.0445e-01, -1.6694e-03],
        [-1.1980e+00,  2.5996e+00, -3.6542e-01,  ..., -8.6866e-01,
         -5.7346e-01,  1.3123e-01]], device='cuda:0')], 2: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0]]), tensor([[ -0.8969,   1.8501,  -0.2616,  ...,  -0.8279,  -0.4875,   0.0695],
        [ -1.0398,   1.9714,  -0.4638,  ...,  -0.4940,  -0.5920,   0.0955],
        [ -0.9147,   1.9003,  -0.3883,  ...,  -0.4510,  -0.5518,   0.0505],
        ...,
        [ -0.7736,   1.6320,  -0.1917,  ...,  -0.6105,  -0.5983,  -0.0707],
        [ -2.9307,   9.1057,   2.0888,  ..., -11.2387,  -2.3051,  -1.3492],
        [ -4.8944,   8.4827,  -0.9331,  ...,  -5.9740,  -0.9788,   0.5207]],
       device='cuda:0'), tensor([[ -0.8957,   1.9085,  -0.3081,  ...,  -0.4549,  -0.5613,  -0.0262],
        [ -4.3107,  13.2599,   2.7362,  ..., -16.3839,  -3.3788,  -1.7463],
        [ -0.8052,   1.7640,  -0.2645,  ...,  -0.4166,  -0.5824,  -0.0652],
        ...,
        [ -0.6853,   1.5825,  -0.0521,  ...,  -0.7040,  -0.6270,  -0.0201],
        [ -0.8921,   2.2992,   0.3200,  ...,  -2.2243,  -0.6896,  -0.1717],
        [ -2.0915,   8.1300,   1.0912,  ...,  -5.8377,  -0.9349,  -0.5800]],
       device='cuda:0'), tensor([[-1.2313,  2.2255, -0.4290,  ..., -0.7863, -0.5828,  0.1222],
        [-0.9919,  2.6752,  0.0409,  ..., -1.4228, -0.5961, -0.0119],
        [-1.6303,  4.2767,  0.6927,  ..., -4.6978, -1.0779, -0.4864],
        ...,
        [-0.7173,  1.4985, -0.0817,  ..., -0.4793, -0.6400, -0.1115],
        [-1.8057,  6.8822,  0.8392,  ..., -4.9447, -0.9433, -0.4538],
        [-1.6486,  5.0681, -0.0320,  ..., -2.7062, -0.6836, -0.1065]],
       device='cuda:0'), tensor([[ -0.7890,   1.7437,  -0.1929,  ...,  -0.5403,  -0.5669,   0.0215],
        [ -4.2838,  12.7322,   2.5392,  ..., -15.6439,  -3.2074,  -1.5567],
        [ -0.7637,   1.6415,  -0.1414,  ...,  -0.4929,  -0.5559,  -0.0603],
        ...,
        [ -1.8958,   6.7112,   0.4572,  ...,  -4.2372,  -0.7964,  -0.3300],
        [ -1.3087,   2.2548,  -0.4273,  ...,  -1.1143,  -0.5810,   0.1288],
        [ -0.7792,   1.6173,  -0.1758,  ...,  -0.4101,  -0.6571,  -0.0908]],
       device='cuda:0')], 3: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0]]), tensor([[-8.0036e-01,  1.6873e+00, -2.4382e-01,  ..., -4.5584e-01,
         -5.9414e-01, -1.6112e-02],
        [-8.9199e-01,  2.1141e+00, -1.7198e-01,  ..., -8.6456e-01,
         -5.9276e-01,  4.4800e-02],
        [-1.2664e+00,  2.4102e+00, -5.1224e-01,  ..., -7.4504e-01,
         -5.7756e-01,  1.6083e-01],
        ...,
        [-5.1824e+00,  1.7282e+01, -1.1192e-01,  ..., -9.4970e+00,
         -7.6149e-01, -6.2524e-01],
        [-1.6261e+00,  5.4991e+00,  1.6912e-01,  ..., -3.2524e+00,
         -8.3143e-01, -1.5745e-01],
        [-2.6563e+00,  5.1276e+00, -1.8631e-01,  ..., -4.6228e+00,
         -1.1335e+00,  3.6767e-02]], device='cuda:0'), tensor([[-1.5813e+00,  2.8687e+00, -2.6376e-01,  ..., -1.9960e+00,
         -7.2126e-01,  6.2321e-02],
        [-3.7049e+00,  1.0924e+01,  2.1653e+00,  ..., -1.3373e+01,
         -2.7980e+00, -1.3188e+00],
        [-6.9598e-01,  1.4591e+00, -8.5967e-02,  ..., -4.6861e-01,
         -6.1234e-01, -1.0036e-01],
        ...,
        [-9.1153e-01,  1.8491e+00, -2.7201e-01,  ..., -4.9537e-01,
         -6.0022e-01,  2.1995e-03],
        [-5.9792e+00,  1.7822e+01,  3.4939e+00,  ..., -2.1948e+01,
         -4.4372e+00, -2.2632e+00],
        [-2.0670e+00,  5.5559e+00,  8.9313e-01,  ..., -6.3176e+00,
         -1.4056e+00, -5.7977e-01]], device='cuda:0'), tensor([[-1.0592e+00,  2.1901e+00, -4.4302e-01,  ..., -5.2686e-01,
         -5.9810e-01,  8.3650e-02],
        [-2.2009e+00,  8.3810e+00,  8.1368e-01,  ..., -5.9420e+00,
         -9.1197e-01, -4.4028e-01],
        [-2.7764e+00,  1.1157e+01,  1.5258e+00,  ..., -8.2141e+00,
         -1.2019e+00, -8.5268e-01],
        ...,
        [-1.2079e+00,  3.8020e+00,  8.6283e-01,  ..., -4.4294e+00,
         -1.0829e+00, -5.0662e-01],
        [-8.9560e-01,  1.9463e+00, -3.7912e-01,  ..., -4.4550e-01,
         -5.7376e-01,  1.1577e-03],
        [-7.9171e-01,  2.1861e+00,  3.9572e-02,  ..., -1.2345e+00,
         -5.6921e-01, -3.0662e-02]], device='cuda:0'), tensor([[ -1.6322,   2.9273,  -0.6952,  ...,  -1.0909,  -0.6403,   0.2732],
        [ -3.9651,  12.2114,   2.6508,  ..., -15.2521,  -3.0740,  -1.6822],
        [ -0.9917,   2.4637,   0.2093,  ...,  -2.2627,  -0.7093,  -0.1881],
        ...,
        [ -1.7416,   4.3841,   0.3389,  ...,  -4.3755,  -1.2318,  -0.3710],
        [ -0.8394,   1.8028,  -0.2484,  ...,  -0.4828,  -0.5974,  -0.0206],
        [ -1.1673,   3.8122,   0.2263,  ...,  -2.4292,  -0.6147,  -0.1474]],
       device='cuda:0')]})
client_new_labels {}
configs.iid_clients
configs.iid_clients
configs.iid_clients
configs.iid_clients
configs.iid_clients
avgkd
avgkd
avgkd
exp path: ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4
Experiment in ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4 already present
Press e to exit, r to replace it: avgkd
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
['./__pycache__/', './.ipynb_checkpoints/', './imgs/', './expt_dump_old/', './expt_dump/', './expt_dump/svhn/iid/'] ['./utils/', './expt_dump/', './__pycache__/', './imgs/', './models/', './algos/', './configs/']
source code copied to exp_dump
avgkd
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Model resnet18 loading on device cuda:2
Model resnet18 loading on device cuda:1
Model resnet18 loading on device cuda:3
Model resnet18 loading on device cuda:0
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Model resnet18 loaded on device cuda:1
Model resnet18 loaded on device cuda:2
Model resnet18 loaded on device cuda:3
Model resnet18 loaded on device cuda:0
Model resnet18 loading on device cuda:0
Model resnet18 loaded on device cuda:0
Client 2 finished training with loss (18.162038564682007, 0.143)
Client 4 finished training with loss (14.410942554473877, 0.121)
Client 1 finished training with loss (17.95677876472473, 0.129)
Client 3 finished training with loss (19.571942806243896, 0.119)
Client 4 finished training with loss (14.48365044593811, 0.105)
Client 2 finished training with loss (20.485618352890015, 0.106)
Client 1 finished training with loss (15.50761103630066, 0.076)
Client 3 finished training with loss (23.743582725524902, 0.08)
Client 4 finished training with loss (12.762295007705688, 0.14)
Client 2 finished training with loss (13.014553308486938, 0.18)
Client 3 finished training with loss (16.12376117706299, 0.106)
Client 1 finished training with loss (12.729870557785034, 0.157)
Client 4 finished training with loss (12.19577145576477, 0.126)
Client 2 finished training with loss (9.994688272476196, 0.105)
Client 3 finished training with loss (11.437437295913696, 0.201)
Client 1 finished training with loss (10.876801490783691, 0.136)
Client 4 finished training with loss (10.190814971923828, 0.171)
Client 2 finished training with loss (9.861006736755371, 0.11)
Client 3 finished training with loss (10.879287481307983, 0.151)
Client 1 finished training with loss (10.13070011138916, 0.122)
1 44750336
client_node_1 1
2 44750336
3 91335680
client_node_2 2
4 91335680
5 91335680
6 94481408
7 94481408
8 94491648
9 94491648
5 91345920
6 94491648
7 94491648
8 94501888
9 94501888
5 91356160
6 94501888
7 94501888
8 94512128
9 94512128
5 91366400
6 94217216
7 94217216
8 94226944
9 94226944
client_node_2 3
4 91376128
5 91376128
6 94521856
7 94521856
8 94532096
9 94532096
5 91386368
6 94532096
7 94532096
8 94542336
9 94542336
5 91396608
6 94542336
7 94542336
8 94552576
9 94552576
5 91406848
6 94257664
7 94257664
8 94267392
9 94267392
client_node_2 4
4 91416576
5 91416576
6 94562304
7 94562304
8 94572544
9 94572544
5 91426816
6 94572544
7 94572544
8 94582784
9 94582784
5 91437056
6 94582784
7 94582784
8 94593024
9 94593024
5 91447296
6 94298112
7 94298112
8 94307840
9 94307840
1 91457024
client_node_1 2
2 91345408
3 137013248
client_node_2 1
4 137013248
5 137013248
6 140158976
7 140158976
8 140159488
9 140159488
5 137013760
6 140159488
7 140159488
8 140169728
9 140169728
5 137024000
6 140169728
7 140169728
8 140179968
9 140179968
5 137034240
6 139885056
7 139885056
8 139894784
9 139894784
client_node_2 3
4 137043968
5 137043968
6 140189696
7 140189696
8 140199936
9 140199936
5 137054208
6 140199936
7 140199936
8 140210176
9 140210176
5 137064448
6 140210176
7 140210176
8 140220416
9 140220416
5 137074688
6 139925504
7 139925504
8 139935232
9 139935232
client_node_2 4
4 137084416
5 137084416
6 140230144
7 140230144
8 140240384
9 140240384
5 137094656
6 140240384
7 140240384
8 140250624
9 140250624
5 137104896
6 140250624
7 140250624
8 140260864
9 140260864
5 137115136
6 139965952
7 139965952
8 139975680
9 139975680
1 137124864
client_node_1 3
2 137013248
3 183729664
client_node_2 1
4 183729664
5 183729664
6 186875392
7 186875392
8 186875904
9 186875904
5 183730176
6 186875904
7 186875904
8 186886144
9 186886144
5 183740416
6 186886144
7 186886144
8 186896384
9 186896384
5 183750656
6 186601472
7 186601472
8 186611200
9 186611200
client_node_2 2
4 183760384
5 183760384
6 186906112
7 186906112
8 186916352
9 186916352
5 183770624
6 186916352
7 186916352
8 186926592
9 186926592
5 183780864
6 186926592
7 186926592
8 186936832
9 186936832
5 183791104
6 186641920
7 186641920
8 186651648
9 186651648
client_node_2 4
4 183800832
5 183800832
6 186946560
7 186946560
8 186956800
9 186956800
5 183811072
6 186956800
7 186956800
8 186967040
9 186967040
5 183821312
6 186967040
7 186967040
8 186977280
9 186977280
5 183831552
6 186682368
7 186682368
8 186692096
9 186692096
1 183841280
client_node_1 4
2 183729664
3 229397504
client_node_2 1
4 229397504
5 229397504
6 232543232
7 232543232
8 232543744
9 232543744
5 229398016
6 232543744
7 232543744
8 232553984
9 232553984
5 229408256
6 232553984
7 232553984
8 232564224
9 232564224
5 229418496
6 232269312
7 232269312
8 232279040
9 232279040
client_node_2 2
4 229428224
5 229428224
6 232573952
7 232573952
8 232584192
9 232584192
5 229438464
6 232584192
7 232584192
8 232594432
9 232594432
5 229448704
6 232594432
7 232594432
8 232604672
9 232604672
5 229458944
6 232309760
7 232309760
8 232319488
9 232319488
client_node_2 3
4 229468672
5 229468672
6 232614400
7 232614400
8 232624640
9 232624640
5 229478912
6 232624640
7 232624640
8 232634880
9 232634880
5 229489152
6 232634880
7 232634880
8 232645120
9 232645120
5 229499392
6 232350208
7 232350208
8 232359936
9 232359936
defaultdict(<class 'list'>, {1: [tensor([[0, 0, 0,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]]), tensor([[-1.4686e+03,  1.1622e+03,  6.6095e+02,  ...,  5.9074e+02,
         -1.3372e+03,  3.5121e+02],
        [-7.4189e+01,  6.8216e+01,  2.9332e+01,  ...,  2.7648e+01,
         -7.2628e+01,  2.2655e+01],
        [-5.7048e-01,  2.5837e+00, -2.6738e-02,  ..., -2.6992e-01,
         -1.3673e+00,  5.2805e-01],
        ...,
        [-1.3701e+00,  3.5791e+00,  2.9030e-01,  ...,  2.2974e-02,
         -2.3303e+00,  9.8537e-01],
        [-5.0740e+02,  4.0791e+02,  2.2690e+02,  ...,  2.0056e+02,
         -4.6741e+02,  1.3191e+02],
        [-6.6883e-02,  1.9743e+00,  5.6174e-03,  ..., -3.5808e-01,
         -8.3722e-01,  1.7706e-01]], device='cuda:0'), tensor([[-9.2923e+00,  1.3360e+01,  2.3217e+00,  ...,  1.9179e+00,
         -1.0357e+01,  3.9138e+00],
        [-1.7181e+01,  1.6236e+01,  6.6921e+00,  ...,  6.1485e+00,
         -1.7138e+01,  5.1308e+00],
        [-3.3768e+00,  4.8923e+00,  9.5541e-01,  ...,  8.1864e-01,
         -4.1412e+00,  1.4872e+00],
        ...,
        [-4.2497e-01,  2.9629e+00, -1.9259e-01,  ..., -6.1863e-01,
         -1.2713e+00,  5.7068e-01],
        [-5.9303e+01,  4.7296e+01,  2.6551e+01,  ...,  2.3536e+01,
         -5.4302e+01,  1.4108e+01],
        [ 4.2753e-02,  1.2122e+00,  2.7616e-01,  ..., -2.9884e-01,
         -5.2974e-01, -6.4800e-02]], device='cuda:0'), tensor([[-1.7223e+02,  1.5578e+02,  7.0436e+01,  ...,  6.6553e+01,
         -1.6819e+02,  5.2902e+01],
        [-1.4340e+02,  1.1359e+02,  6.4430e+01,  ...,  5.6001e+01,
         -1.2866e+02,  3.2632e+01],
        [-6.0995e+01,  5.7641e+01,  2.3156e+01,  ...,  2.2001e+01,
         -5.8955e+01,  1.7334e+01],
        ...,
        [-6.7412e-02,  1.3905e+00,  2.1960e-01,  ..., -4.0347e-01,
         -6.3565e-01,  7.2552e-03],
        [-7.0660e-03,  1.4352e+00,  1.8464e-01,  ..., -3.9400e-01,
         -6.0379e-01,  1.3244e-03],
        [-1.0916e+01,  1.1390e+01,  4.1343e+00,  ...,  3.9374e+00,
         -1.1394e+01,  3.4439e+00]], device='cuda:0'), tensor([[-1.5298e+02,  1.2872e+02,  6.5404e+01,  ...,  5.9512e+01,
         -1.4223e+02,  3.7891e+01],
        [-1.2300e-01,  2.2024e+00, -4.2222e-02,  ..., -5.4563e-01,
         -9.0189e-01,  2.4359e-01],
        [-1.1731e+01,  1.9867e+01,  2.2536e+00,  ...,  2.0375e+00,
         -1.4650e+01,  6.6906e+00],
        ...,
        [ 2.9159e-03,  1.9360e+00,  1.6331e-02,  ..., -4.5731e-01,
         -7.4944e-01,  9.6239e-02],
        [-1.1540e+02,  1.0268e+02,  4.6970e+01,  ...,  4.4045e+01,
         -1.1059e+02,  3.2450e+01],
        [-1.2160e+02,  1.1256e+02,  4.7095e+01,  ...,  4.5225e+01,
         -1.1497e+02,  3.2654e+01]], device='cuda:0')], 2: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0]]), tensor([[ -7.9967,   9.8887,   2.5934,  ...,   2.3387,  -8.7352,   3.0975],
        [ -2.3525,   4.8652,   0.3651,  ...,   0.2693,  -3.3585,   1.5301],
        [ -0.1475,   2.3612,  -0.1013,  ...,  -0.4882,  -0.9350,   0.3007],
        ...,
        [ -1.6990,   3.7074,   0.2531,  ...,  -0.0336,  -2.4295,   0.9092],
        [-24.2708,  20.8345,  10.2915,  ...,   9.3424, -22.4758,   5.7659],
        [ -6.4986,   7.9372,   2.2007,  ...,   2.0383,  -7.3532,   2.4616]],
       device='cuda:0'), tensor([[-2.4189e-01,  2.3490e+00,  1.3830e-02,  ..., -4.0673e-01,
         -1.0347e+00,  3.5727e-01],
        [-4.9468e-01,  2.7264e+00, -8.0603e-02,  ..., -3.9357e-01,
         -1.3780e+00,  5.1393e-01],
        [ 7.9742e-03,  1.1514e+00,  3.1456e-01,  ..., -2.6606e-01,
         -5.4601e-01, -7.6478e-02],
        ...,
        [-4.7696e+00,  9.3690e+00,  5.7557e-01,  ...,  3.3904e-01,
         -6.3169e+00,  3.0683e+00],
        [-2.3460e+00,  4.5598e+00,  4.1213e-01,  ...,  1.6004e-01,
         -3.2351e+00,  1.1883e+00],
        [-7.8573e+02,  6.2129e+02,  3.5142e+02,  ...,  3.1282e+02,
         -7.1171e+02,  1.8781e+02]], device='cuda:0'), tensor([[-4.3707e-01,  2.8487e+00, -1.5921e-01,  ..., -5.3839e-01,
         -1.2674e+00,  5.2915e-01],
        [-1.5141e+01,  1.9908e+01,  4.0858e+00,  ...,  3.9813e+00,
         -1.6790e+01,  6.8021e+00],
        [-2.8140e-02,  1.3218e+00,  2.6314e-01,  ..., -3.3814e-01,
         -5.8494e-01, -3.9396e-02],
        ...,
        [-3.3220e+00,  7.2352e+00,  2.9656e-01,  ..., -6.7727e-02,
         -4.5896e+00,  2.1541e+00],
        [-7.0369e+02,  5.6115e+02,  3.1364e+02,  ...,  2.8202e+02,
         -6.4220e+02,  1.7010e+02],
        [-8.6553e+02,  6.7587e+02,  3.9207e+02,  ...,  3.4547e+02,
         -7.7838e+02,  2.0356e+02]], device='cuda:0'), tensor([[-9.6997e+00,  1.3820e+01,  2.4003e+00,  ...,  2.3423e+00,
         -1.1135e+01,  4.2282e+00],
        [-8.8477e+00,  9.5369e+00,  3.3558e+00,  ...,  2.9961e+00,
         -9.4794e+00,  3.1755e+00],
        [ 1.1459e-01,  1.2819e+00,  2.0324e-01,  ..., -3.1117e-01,
         -5.3404e-01, -7.0736e-02],
        ...,
        [-5.2557e+02,  4.2727e+02,  2.3115e+02,  ...,  2.0875e+02,
         -4.8392e+02,  1.3306e+02],
        [-4.7808e+01,  3.7639e+01,  2.1800e+01,  ...,  1.8825e+01,
         -4.3427e+01,  1.1087e+01],
        [-5.4948e-02,  1.8365e+00,  1.3423e-01,  ..., -5.0558e-01,
         -7.6372e-01,  5.7784e-02]], device='cuda:0')], 3: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0]]), tensor([[-1.8137e+00,  3.3110e+00,  4.1851e-01,  ...,  1.1189e-01,
         -2.4202e+00,  7.7414e-01],
        [-1.2953e+02,  1.0524e+02,  5.7933e+01,  ...,  4.9920e+01,
         -1.1798e+02,  3.2782e+01],
        [-2.3591e+01,  2.7400e+01,  7.6194e+00,  ...,  7.4939e+00,
         -2.4672e+01,  8.2404e+00],
        ...,
        [-1.0169e+03,  8.1344e+02,  4.5568e+02,  ...,  4.0624e+02,
         -9.3376e+02,  2.5455e+02],
        [-2.6959e+02,  2.3144e+02,  1.1378e+02,  ...,  1.0568e+02,
         -2.5543e+02,  7.7100e+01],
        [-1.1137e+01,  1.1203e+01,  4.3980e+00,  ...,  3.8251e+00,
         -1.1454e+01,  3.6065e+00]], device='cuda:0'), tensor([[-4.2957e-02,  1.2920e+00,  2.6105e-01,  ..., -3.2369e-01,
         -5.6935e-01, -5.8971e-02],
        [-5.6077e+00,  6.1673e+00,  2.0213e+00,  ...,  1.7198e+00,
         -5.7766e+00,  1.5384e+00],
        [ 3.2875e-03,  1.6050e+00,  1.1641e-01,  ..., -4.5824e-01,
         -6.6843e-01, -2.2956e-03],
        ...,
        [-2.4792e+00,  5.5327e+00,  2.6245e-01,  ..., -4.1508e-01,
         -3.4027e+00,  1.2706e+00],
        [-7.9065e+01,  6.0754e+01,  3.6546e+01,  ...,  3.1523e+01,
         -7.1011e+01,  1.7824e+01],
        [-1.9263e+01,  1.7250e+01,  7.9369e+00,  ...,  7.3723e+00,
         -1.8409e+01,  5.0468e+00]], device='cuda:0'), tensor([[-2.0454e+01,  2.1934e+01,  7.0333e+00,  ...,  6.1344e+00,
         -2.0090e+01,  6.3984e+00],
        [-5.5996e+02,  4.6249e+02,  2.4648e+02,  ...,  2.1939e+02,
         -5.2338e+02,  1.5313e+02],
        [-1.6474e+03,  1.2762e+03,  7.5256e+02,  ...,  6.6270e+02,
         -1.4765e+03,  3.6710e+02],
        ...,
        [-3.3025e+00,  5.4696e+00,  8.4837e-01,  ...,  4.2404e-01,
         -4.2516e+00,  1.5283e+00],
        [-1.5822e+00,  3.8604e+00,  1.5971e-01,  ...,  2.7948e-02,
         -2.5168e+00,  1.0027e+00],
        [-2.8854e+01,  2.9383e+01,  1.0572e+01,  ...,  9.9848e+00,
         -2.9205e+01,  9.6532e+00]], device='cuda:0'), tensor([[-4.9775e-02,  2.2436e+00, -1.2280e-01,  ..., -6.3831e-01,
         -8.4617e-01,  2.1910e-01],
        [-9.4428e+00,  1.0072e+01,  3.4672e+00,  ...,  3.2673e+00,
         -9.8018e+00,  3.1966e+00],
        [-1.5760e+00,  4.9432e+00, -3.5526e-02,  ..., -3.6284e-01,
         -2.7475e+00,  1.3416e+00],
        ...,
        [-1.1039e-01,  2.0760e+00, -5.6149e-02,  ..., -3.9378e-01,
         -8.7638e-01,  2.1936e-01],
        [-2.3919e-01,  2.8668e+00, -1.7474e-01,  ..., -7.1829e-01,
         -1.1545e+00,  4.4479e-01],
        [-4.9442e+02,  4.0264e+02,  2.1909e+02,  ...,  1.9507e+02,
         -4.5862e+02,  1.2967e+02]], device='cuda:0')]})
client_new_labels {}
configs.iid_clients
configs.iid_clients
configs.iid_clients
configs.iid_clients
exp path: ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4
avgkd
Experiment in ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4 already present
Press e to exit, r to replace it: avgkd
avgkd
configs.iid_clients
avgkd
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
['./__pycache__/', './.ipynb_checkpoints/', './imgs/', './expt_dump_old/', './expt_dump/', './expt_dump/svhn/iid/'] ['./utils/', './expt_dump/', './__pycache__/', './imgs/', './models/', './algos/', './configs/']
source code copied to exp_dump
avgkd
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Model resnet18 loading on device cuda:0
Model resnet18 loading on device cuda:3
Model resnet18 loading on device cuda:2
Model resnet18 loading on device cuda:1
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Model resnet18 loaded on device cuda:0
Model resnet18 loaded on device cuda:2
Model resnet18 loaded on device cuda:3
Model resnet18 loaded on device cuda:1
Model resnet18 loading on device cuda:0
Model resnet18 loaded on device cuda:0
Client 4 finished training with loss (14.415461778640747, 0.121)
Client 3 finished training with loss (19.575743198394775, 0.119)
Client 1 finished training with loss (17.92599606513977, 0.129)
Client 2 finished training with loss (18.156770944595337, 0.143)
Client 4 finished training with loss (14.697777509689331, 0.107)
Client 3 finished training with loss (23.043933391571045, 0.082)
Client 2 finished training with loss (19.857491731643677, 0.088)
Client 1 finished training with loss (15.534732818603516, 0.084)
Client 4 finished training with loss (15.856621026992798, 0.134)
Client 3 finished training with loss (14.59235429763794, 0.104)
Client 2 finished training with loss (12.67966079711914, 0.17)
Client 1 finished training with loss (11.471453666687012, 0.158)
Client 4 finished training with loss (14.169157028198242, 0.134)
Client 3 finished training with loss (10.770114421844482, 0.208)
Client 2 finished training with loss (9.976090669631958, 0.116)
Client 1 finished training with loss (10.495834827423096, 0.153)
Client 4 finished training with loss (10.837133884429932, 0.162)
Client 3 finished training with loss (10.321427345275879, 0.2)
Client 2 finished training with loss (9.708565473556519, 0.105)
Client 1 finished training with loss (9.897489309310913, 0.095)
1 44750336
client_node_1 1
2 44750336
3 91335680
client_node_2 2
4 91335680
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94186496
7 94186496
8 94196224
9 94186496
client_node_2 3
4 91335680
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94186496
7 94186496
8 94196224
9 94186496
client_node_2 4
4 91335680
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94186496
7 94186496
8 94196224
9 94186496
1 91335680
client_node_1 2
2 91335680
3 137003520
client_node_2 1
4 137003520
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 139854336
7 139854336
8 139864064
9 139854336
client_node_2 3
4 137003520
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 139854336
7 139854336
8 139864064
9 139854336
client_node_2 4
4 137003520
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 139854336
7 139854336
8 139864064
9 139854336
1 137003520
client_node_1 3
2 137003520
3 183719936
client_node_2 1
4 183719936
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186570752
7 186570752
8 186580480
9 186570752
client_node_2 2
4 183719936
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186570752
7 186570752
8 186580480
9 186570752
client_node_2 4
4 183719936
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186570752
7 186570752
8 186580480
9 186570752
1 183719936
client_node_1 4
2 183719936
3 229387776
client_node_2 1
4 229387776
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232238592
7 232238592
8 232248320
9 232238592
client_node_2 2
4 229387776
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232238592
7 232238592
8 232248320
9 232238592
client_node_2 3
4 229387776
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232238592
7 232238592
8 232248320
9 232238592
defaultdict(<class 'list'>, {1: [tensor([[0, 0, 0,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]]), tensor([[ 4.1202e+02,  8.6203e+02,  9.6183e+02,  ...,  6.6893e+02,
         -1.1659e+03, -1.1335e+03],
        [ 6.3502e+01,  1.3873e+02,  1.4983e+02,  ...,  1.0411e+02,
         -1.8117e+02, -1.7936e+02],
        [-2.3694e-01,  1.0383e+00,  7.0440e-01,  ...,  6.8669e-02,
          5.1414e-02, -7.4076e-01],
        ...,
        [-2.7727e-01,  9.3389e-01,  9.5533e-01,  ..., -8.2492e-02,
         -8.7429e-02, -7.6176e-01],
        [ 1.3124e+02,  3.3182e+02,  3.3464e+02,  ...,  2.3943e+02,
         -3.6675e+02, -4.0607e+02],
        [-2.5159e-01,  7.3591e-01,  1.0181e+00,  ..., -1.0917e-01,
         -1.6229e-01, -7.2250e-01]]), tensor([[ 4.6420e+01,  8.5693e+01,  9.7630e+01,  ...,  6.5551e+01,
         -1.3620e+02, -1.1598e+02],
        [ 2.6004e+00,  8.4806e+00,  7.4616e+00,  ...,  5.0436e+00,
         -8.9503e+00, -9.5937e+00],
        [-3.3699e-01,  3.6344e+00,  1.9861e+00,  ...,  8.7893e-01,
         -9.1887e-01, -2.7006e+00],
        ...,
        [-3.8635e-02,  6.0568e+00,  3.9861e+00,  ...,  2.0008e+00,
         -1.5821e+00, -4.8534e+00],
        [-2.2901e-01,  1.2903e+00,  6.5252e-01,  ...,  1.7681e-01,
         -4.4661e-02, -8.8165e-01],
        [-2.2923e-01,  6.6576e-01,  1.0549e+00,  ..., -1.1000e-01,
         -2.0734e-01, -7.0164e-01]]), tensor([[ 9.4126e+01,  2.2792e+02,  2.3765e+02,  ...,  1.6920e+02,
         -2.6661e+02, -2.8702e+02],
        [ 7.2584e+01,  1.4019e+02,  1.5598e+02,  ...,  1.0607e+02,
         -2.1098e+02, -1.8547e+02],
        [ 8.6902e+01,  1.5851e+02,  1.8318e+02,  ...,  1.2318e+02,
         -2.5402e+02, -2.1572e+02],
        ...,
        [-2.6841e-01,  4.2525e+00,  2.5777e+00,  ...,  1.1254e+00,
         -5.2051e-01, -3.1511e+00],
        [-4.3687e-01,  2.4248e+00,  1.2577e+00,  ...,  2.8292e-01,
         -1.1690e-01, -1.6634e+00],
        [-2.4065e-01,  9.1346e-01,  8.2719e-01,  ..., -5.2931e-03,
          2.3152e-02, -7.2226e-01]]), tensor([[ 1.0005e+02,  1.8906e+02,  2.1545e+02,  ...,  1.4648e+02,
         -2.9018e+02, -2.5465e+02],
        [ 6.4499e-02,  5.0628e+00,  3.3782e+00,  ...,  1.7400e+00,
         -1.2197e+00, -4.0828e+00],
        [ 1.4521e+01,  6.2565e+01,  5.3542e+01,  ...,  3.6140e+01,
         -4.2042e+01, -6.5267e+01],
        ...,
        [-2.4709e-01,  8.7449e-01,  1.0208e+00,  ..., -7.9354e-02,
         -1.2445e-01, -7.6540e-01],
        [ 9.8071e+01,  1.9671e+02,  2.2180e+02,  ...,  1.5243e+02,
         -2.8326e+02, -2.6160e+02],
        [ 1.3107e+02,  2.3300e+02,  2.7039e+02,  ...,  1.8108e+02,
         -3.8209e+02, -3.1965e+02]])], 2: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0]]), tensor([[ 1.9926e+00,  1.0661e+01,  8.4181e+00,  ...,  6.0738e+00,
         -6.7449e+00, -1.1140e+01],
        [ 2.8549e+00,  1.1451e+01,  9.3520e+00,  ...,  6.7196e+00,
         -9.7413e+00, -1.2618e+01],
        [-2.8970e-01,  9.3208e-01,  1.0450e+00,  ..., -1.1428e-01,
         -1.3191e-01, -7.9799e-01],
        ...,
        [-2.1382e-01,  2.5679e+00,  1.5765e+00,  ...,  3.8848e-01,
         -4.0368e-01, -1.8362e+00],
        [-2.4227e-01,  8.3650e-01,  9.4741e-01,  ..., -8.5471e-02,
         -9.7710e-02, -7.4501e-01],
        [-2.0114e-01,  7.5117e-01,  9.0774e-01,  ..., -5.2950e-02,
         -8.1932e-03, -6.6872e-01]]), tensor([[-4.1813e-01,  2.4808e+00,  1.2911e+00,  ...,  3.4471e-01,
         -1.2115e-01, -1.7443e+00],
        [-2.3995e-01,  1.2039e+00,  6.6921e-01,  ...,  1.3646e-01,
         -5.2842e-02, -8.6146e-01],
        [-2.0267e-01,  5.6492e-01,  1.0825e+00,  ..., -1.1844e-01,
         -2.9856e-01, -6.8144e-01],
        ...,
        [ 6.5585e+00,  2.2866e+01,  2.1170e+01,  ...,  1.4866e+01,
         -2.0004e+01, -2.6041e+01],
        [ 3.9182e-01,  6.3466e+00,  4.4105e+00,  ...,  2.7550e+00,
         -2.2182e+00, -5.7006e+00],
        [ 2.9082e+02,  5.6327e+02,  6.4785e+02,  ...,  4.4142e+02,
         -8.3276e+02, -7.5545e+02]]), tensor([[ 6.7499e-01,  6.4744e+00,  4.5458e+00,  ...,  2.9041e+00,
         -3.9820e+00, -6.1762e+00],
        [ 3.7449e+01,  8.5316e+01,  9.2048e+01,  ...,  6.3849e+01,
         -1.0870e+02, -1.0945e+02],
        [-3.7956e-01,  1.6505e+00,  1.1204e+00,  ...,  6.3725e-03,
         -5.5744e-02, -1.1242e+00],
        ...,
        [ 2.3014e+01,  5.5622e+01,  5.8141e+01,  ...,  4.0799e+01,
         -6.6184e+01, -6.9973e+01],
        [ 2.5757e+02,  5.1036e+02,  5.8259e+02,  ...,  4.0033e+02,
         -7.3543e+02, -6.8267e+02],
        [ 3.6217e+02,  6.9484e+02,  8.1048e+02,  ...,  5.4645e+02,
         -1.0408e+03, -9.3243e+02]]), tensor([[ 1.2783e+01,  3.1923e+01,  3.2418e+01,  ...,  2.2879e+01,
         -3.8268e+01, -3.9925e+01],
        [-1.8459e-01,  6.3299e-01,  9.4674e-01,  ..., -6.1291e-02,
         -6.9978e-02, -6.4751e-01],
        [-3.7889e-01,  1.2981e+00,  9.6000e-01,  ..., -7.0029e-02,
         -4.3724e-02, -9.6818e-01],
        ...,
        [ 2.0898e+02,  4.2051e+02,  4.8086e+02,  ...,  3.2784e+02,
         -5.9996e+02, -5.5882e+02],
        [ 1.5531e-01,  1.5766e+00,  9.3151e-01,  ...,  5.7142e-01,
         -8.7707e-01, -1.3790e+00],
        [ 6.0268e+00,  2.0292e+01,  1.9155e+01,  ...,  1.3705e+01,
         -1.8895e+01, -2.3810e+01]])], 3: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0]]), tensor([[-3.2060e-01,  2.2008e+00,  1.1350e+00,  ...,  2.8778e-01,
         -3.3258e-01, -1.5888e+00],
        [ 9.6451e+01,  1.7852e+02,  2.1110e+02,  ...,  1.3910e+02,
         -2.7845e+02, -2.3925e+02],
        [ 5.7396e+01,  1.1039e+02,  1.2485e+02,  ...,  8.4731e+01,
         -1.6920e+02, -1.4799e+02],
        ...,
        [ 2.7529e+02,  6.2683e+02,  6.7182e+02,  ...,  4.7252e+02,
         -7.7472e+02, -8.0035e+02],
        [ 1.1959e+02,  2.5123e+02,  2.8529e+02,  ...,  1.9428e+02,
         -3.4305e+02, -3.3006e+02],
        [ 3.6414e+00,  1.0828e+01,  9.7776e+00,  ...,  6.7217e+00,
         -1.2022e+01, -1.2579e+01]]), tensor([[-4.9991e-01,  2.4565e+00,  1.1544e+00,  ...,  2.6425e-01,
         -2.7851e-01, -1.7001e+00],
        [-2.4629e-01,  8.0456e-01,  9.5630e-01,  ..., -6.4766e-02,
         -8.0628e-02, -7.3738e-01],
        [ 4.6628e-01,  5.9243e+00,  4.1703e+00,  ...,  2.6209e+00,
         -2.9364e+00, -5.5575e+00],
        ...,
        [ 2.9851e+01,  5.4501e+01,  6.2776e+01,  ...,  4.1426e+01,
         -8.7965e+01, -7.3455e+01],
        [-1.9694e-01,  1.3104e+00,  6.4425e-01,  ...,  2.1840e-01,
         -6.6743e-02, -9.1668e-01],
        [-2.5104e-01,  1.2165e+00,  6.3190e-01,  ...,  1.1584e-01,
         -7.2044e-03, -8.5201e-01]]), tensor([[ 6.8966e+01,  1.1916e+02,  1.4145e+02,  ...,  9.3573e+01,
         -2.0109e+02, -1.6431e+02],
        [ 1.5241e+02,  4.0685e+02,  4.0063e+02,  ...,  2.8799e+02,
         -4.2101e+02, -4.8998e+02],
        [ 4.7206e+02,  9.2174e+02,  1.0443e+03,  ...,  7.1917e+02,
         -1.3525e+03, -1.2314e+03],
        ...,
        [ 5.1896e+00,  2.6376e+01,  2.1420e+01,  ...,  1.3586e+01,
         -1.5064e+01, -2.5523e+01],
        [-4.0891e-01,  1.8354e+00,  1.1541e+00,  ...,  7.8723e-02,
         -1.1776e-01, -1.2759e+00],
        [ 2.2017e+01,  4.9366e+01,  5.2867e+01,  ...,  3.6626e+01,
         -6.4772e+01, -6.3123e+01]]), tensor([[ 2.0312e+00,  8.2342e+00,  6.7535e+00,  ...,  4.7518e+00,
         -7.3597e+00, -9.0555e+00],
        [-2.1092e-01,  7.3841e-01,  8.9781e-01,  ..., -2.8801e-02,
         -1.4781e-02, -6.6597e-01],
        [ 7.6492e-01,  7.9309e+00,  5.7727e+00,  ...,  3.0600e+00,
         -2.8424e+00, -6.6415e+00],
        ...,
        [-2.1582e-01,  6.3121e-01,  1.0430e+00,  ..., -1.0834e-01,
         -2.5680e-01, -7.0026e-01],
        [ 1.4368e+00,  8.4671e+00,  6.5173e+00,  ...,  4.4287e+00,
         -5.6827e+00, -8.5013e+00],
        [ 1.5180e+02,  3.7326e+02,  3.8012e+02,  ...,  2.7228e+02,
         -4.2547e+02, -4.6181e+02]])]})
client_new_labels {}
configs.iid_clients
configs.iid_clients
configs.iid_clients
configs.iid_clients
configs.iid_clients
avgkd
avgkd
exp path: ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4
avgkd
avgkd
Experiment in ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4 already present
Press e to exit, r to replace it: Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
['./__pycache__/', './.ipynb_checkpoints/', './imgs/', './expt_dump_old/', './expt_dump/', './expt_dump/svhn/iid/'] ['./utils/', './expt_dump/', './__pycache__/', './imgs/', './models/', './algos/', './configs/']
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
source code copied to exp_dump
avgkd
Model resnet18 loading on device cuda:0
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Model resnet18 loading on device cuda:2
Model resnet18 loading on device cuda:3
Model resnet18 loading on device cuda:1
Model resnet18 loaded on device cuda:1
Model resnet18 loaded on device cuda:0
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Model resnet18 loaded on device cuda:2
Model resnet18 loaded on device cuda:3
Model resnet18 loading on device cuda:0
Model resnet18 loaded on device cuda:0
Client 4 finished training with loss (14.415723323822021, 0.12)
Client 3 finished training with loss (19.57276725769043, 0.119)
Client 2 finished training with loss (18.16768503189087, 0.142)
Client 1 finished training with loss (17.95865750312805, 0.129)
Client 4 finished training with loss (14.430705070495605, 0.106)
Client 2 finished training with loss (19.73318886756897, 0.089)
Client 3 finished training with loss (23.261313915252686, 0.08)
Client 1 finished training with loss (15.432513236999512, 0.083)
Client 4 finished training with loss (14.380358934402466, 0.132)
Client 3 finished training with loss (16.11533212661743, 0.104)
Client 2 finished training with loss (12.063530445098877, 0.173)
Client 1 finished training with loss (11.338731050491333, 0.16)
Client 4 finished training with loss (11.49671721458435, 0.136)
Client 3 finished training with loss (11.8744056224823, 0.21)
Client 2 finished training with loss (10.076548099517822, 0.144)
Client 1 finished training with loss (10.425410032272339, 0.167)
Client 4 finished training with loss (10.395042419433594, 0.165)
Client 3 finished training with loss (11.029322147369385, 0.154)
Client 2 finished training with loss (9.895781755447388, 0.106)
Client 1 finished training with loss (10.059793472290039, 0.109)
1 44750336
client_node_1 1
2 44750336
3 91335680
client_node_2 2
4 91335680
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94186496
7 94186496
8 94196224
9 94186496
client_node_2 3
4 91335680
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94186496
7 94186496
8 94196224
9 94186496
client_node_2 4
4 91335680
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94186496
7 94186496
8 94196224
9 94186496
1 91335680
client_node_1 2
2 91335680
3 137003520
client_node_2 1
4 137003520
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 139854336
7 139854336
8 139864064
9 139854336
client_node_2 3
4 137003520
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 139854336
7 139854336
8 139864064
9 139854336
client_node_2 4
4 137003520
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 139854336
7 139854336
8 139864064
9 139854336
1 137003520
client_node_1 3
2 137003520
3 183719936
client_node_2 1
4 183719936
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186570752
7 186570752
8 186580480
9 186570752
client_node_2 2
4 183719936
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186570752
7 186570752
8 186580480
9 186570752
client_node_2 4
4 183719936
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186865664
7 186865664
8 186875904
9 186865664
5 183719936
6 186570752
7 186570752
8 186580480
9 186570752
1 183719936
client_node_1 4
2 183719936
3 229387776
client_node_2 1
4 229387776
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232238592
7 232238592
8 232248320
9 232238592
client_node_2 2
4 229387776
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232238592
7 232238592
8 232248320
9 232238592
client_node_2 3
4 229387776
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232533504
7 232533504
8 232543744
9 232533504
5 229387776
6 232238592
7 232238592
8 232248320
9 232238592
defaultdict(<class 'list'>, {1: [tensor([[0, 0, 0,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]]), tensor([[-2.0324e+03, -1.3901e+00,  6.4091e+02,  ...,  7.0098e+02,
         -1.1028e+03,  1.7104e+02],
        [-7.0450e+02,  1.9453e+00,  2.2140e+02,  ...,  2.4420e+02,
         -3.8426e+02,  6.0474e+01],
        [-3.0992e-01,  9.1633e-01,  3.5630e-01,  ..., -4.8366e-01,
         -5.9969e-01, -5.2390e-01],
        ...,
        [-2.5701e+02,  1.1455e+00,  8.0106e+01,  ...,  8.6847e+01,
         -1.3865e+02,  1.8784e+01],
        [-7.0640e+02, -5.1349e+00,  2.2532e+02,  ...,  2.4287e+02,
         -3.7951e+02,  5.9379e+01],
        [-3.8089e+02,  2.7781e+00,  1.1894e+02,  ...,  1.3141e+02,
         -2.0821e+02,  3.2328e+01]]), tensor([[-2.5138e+01,  1.0412e+00,  7.6932e+00,  ...,  7.4464e+00,
         -1.3861e+01,  6.2718e-01],
        [ 4.9042e-01,  8.8595e-01,  1.0104e-01,  ..., -6.5591e-01,
         -1.9671e-01, -7.4632e-01],
        [-1.8255e-02,  6.6214e-01,  5.0252e-01,  ..., -3.7172e-01,
         -3.5753e-01, -4.4411e-01],
        ...,
        [-4.5286e+02, -3.0228e+00,  1.4290e+02,  ...,  1.5383e+02,
         -2.4351e+02,  3.6851e+01],
        [ 1.6689e-01,  9.9158e-01,  9.1211e-02,  ..., -7.2001e-01,
         -3.8856e-01, -8.0996e-01],
        [-2.1277e+00,  1.0795e+00,  5.6842e-01,  ..., -3.7185e-01,
         -1.6478e+00, -1.0564e+00]]), tensor([[-2.5631e+02, -3.6127e+00,  8.1081e+01,  ...,  8.5590e+01,
         -1.3573e+02,  1.8277e+01],
        [-8.9915e+02,  5.2449e+00,  2.8368e+02,  ...,  3.1378e+02,
         -4.9246e+02,  7.9928e+01],
        [-2.6741e+02,  3.9495e-01,  8.4322e+01,  ...,  9.2176e+01,
         -1.4583e+02,  2.3119e+01],
        ...,
        [-8.3531e+02, -3.7457e-01,  2.6359e+02,  ...,  2.8898e+02,
         -4.5348e+02,  7.2272e+01],
        [-1.9693e+02, -2.0542e+00,  6.2239e+01,  ...,  6.6148e+01,
         -1.0464e+02,  1.4456e+01],
        [-1.6275e+01,  1.5680e-01,  5.2106e+00,  ...,  4.3742e+00,
         -8.6138e+00, -4.9808e-01]]), tensor([[-9.2949e+02,  4.0550e+00,  2.9262e+02,  ...,  3.2349e+02,
         -5.0803e+02,  8.0489e+01],
        [-1.9188e+02, -2.3145e+00,  6.0993e+01,  ...,  6.3485e+01,
         -1.0185e+02,  1.2337e+01],
        [-5.5035e+01, -5.5634e-01,  1.8139e+01,  ...,  1.6450e+01,
         -2.8828e+01,  1.5372e+00],
        ...,
        [-2.2352e+02, -3.4417e+00,  7.1584e+01,  ...,  7.5219e+01,
         -1.1849e+02,  1.6265e+01],
        [-2.6003e+02,  8.0177e-01,  8.1713e+01,  ...,  8.8972e+01,
         -1.4158e+02,  2.1123e+01],
        [-3.3208e+02,  4.2536e+00,  1.0337e+02,  ...,  1.1247e+02,
         -1.8043e+02,  2.5652e+01]])], 2: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0]]), tensor([[-207.9820,   -3.5248,   65.5481,  ...,   66.4109, -107.9696,
            8.9692],
        [ -50.0165,    1.1018,   15.7334,  ...,   16.4701,  -27.3776,
            2.8666],
        [ -79.8850,   -1.2764,   25.3287,  ...,   25.4251,  -41.7471,
            3.7311],
        ...,
        [-261.8888,   -4.0663,   83.1517,  ...,   87.5248, -138.4876,
           18.5718],
        [ -81.7374,   -1.4366,   25.7010,  ...,   26.1063,  -42.7599,
            4.3867],
        [-464.6808,    4.2063,  146.0715,  ...,  162.6223, -255.3923,
           41.0434]]), tensor([[-3.2184e+02,  3.5814e+00,  1.0041e+02,  ...,  1.1146e+02,
         -1.7649e+02,  2.7432e+01],
        [ 6.9139e-02,  8.7139e-01,  1.5662e-01,  ..., -5.8328e-01,
         -4.2074e-01, -6.7763e-01],
        [-3.8765e+02, -1.6161e+00,  1.2296e+02,  ...,  1.3332e+02,
         -2.0957e+02,  3.1913e+01],
        ...,
        [-8.9153e+02, -6.3954e-01,  2.8207e+02,  ...,  3.0807e+02,
         -4.8388e+02,  7.7008e+01],
        [-7.0519e+01, -3.2679e-01,  2.2251e+01,  ...,  2.3706e+01,
         -3.8158e+01,  5.1103e+00],
        [-1.6718e+03,  1.8661e+00,  5.2685e+02,  ...,  5.7894e+02,
         -9.0991e+02,  1.4353e+02]]), tensor([[-3.1358e+02,  1.3213e+00,  9.7782e+01,  ...,  1.0615e+02,
         -1.6953e+02,  2.4414e+01],
        [-3.6280e+02,  1.7012e+00,  1.1421e+02,  ...,  1.2628e+02,
         -1.9877e+02,  3.1511e+01],
        [-1.6620e+02, -1.3571e+00,  5.2657e+01,  ...,  5.6248e+01,
         -8.9001e+01,  1.3063e+01],
        ...,
        [-1.3346e+02, -2.0496e-01,  4.2087e+01,  ...,  4.5549e+01,
         -7.2561e+01,  1.0796e+01],
        [-1.1324e+03,  2.1988e+00,  3.5577e+02,  ...,  3.9167e+02,
         -6.1695e+02,  9.7602e+01],
        [-1.7044e+03,  6.9226e+00,  5.3701e+02,  ...,  5.8826e+02,
         -9.2925e+02,  1.4867e+02]]), tensor([[-6.4591e+02, -1.0230e-01,  2.0293e+02,  ...,  2.2108e+02,
         -3.4895e+02,  5.0644e+01],
        [-1.2691e+01,  6.1353e-01,  3.9284e+00,  ...,  3.1846e+00,
         -6.9204e+00, -5.1000e-01],
        [-2.3482e+01,  4.2160e-01,  7.5351e+00,  ...,  7.1687e+00,
         -1.3002e+01,  8.6946e-01],
        ...,
        [-9.6447e+02,  2.0860e+00,  3.0375e+02,  ...,  3.3321e+02,
         -5.2562e+02,  8.2449e+01],
        [ 3.9110e-01,  7.9044e-01,  2.5997e-01,  ..., -5.8248e-01,
         -2.2091e-01, -6.4962e-01],
        [-3.1981e+02,  9.5928e-01,  1.0080e+02,  ...,  1.1072e+02,
         -1.7445e+02,  2.7862e+01]])], 3: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0]]), tensor([[-2.6756e+02, -4.9403e-01,  8.4775e+01,  ...,  9.0592e+01,
         -1.4418e+02,  1.9527e+01],
        [-3.6379e+02,  3.7088e+00,  1.1544e+02,  ...,  1.2656e+02,
         -1.9946e+02,  3.2415e+01],
        [-5.7771e+01,  1.2670e+00,  1.7898e+01,  ...,  1.7967e+01,
         -3.1094e+01,  2.2130e+00],
        ...,
        [-1.6874e+03, -2.6948e+00,  5.3551e+02,  ...,  5.8402e+02,
         -9.1511e+02,  1.4355e+02],
        [-7.3818e+02,  2.2089e+00,  2.3300e+02,  ...,  2.5585e+02,
         -4.0318e+02,  6.4038e+01],
        [ 4.9695e-01,  1.0448e+00,  1.4226e-01,  ..., -7.4933e-01,
         -2.4667e-01, -7.9726e-01]]), tensor([[-2.0604e+02,  3.0611e+00,  6.4205e+01,  ...,  7.0183e+01,
         -1.1242e+02,  1.6605e+01],
        [-1.3668e+01,  7.7833e-01,  4.1474e+00,  ...,  3.3909e+00,
         -7.4751e+00, -5.3331e-01],
        [-3.2913e+02,  3.9267e-01,  1.0278e+02,  ...,  1.1188e+02,
         -1.7812e+02,  2.5910e+01],
        ...,
        [-5.3611e+01,  7.7501e-01,  1.6897e+01,  ...,  1.8315e+01,
         -2.9701e+01,  4.4284e+00],
        [ 2.6225e-01,  7.6796e-01,  3.0606e-01,  ..., -5.3428e-01,
         -3.0198e-01, -6.2295e-01],
        [-3.2349e+00,  4.7078e-01,  1.1037e+00,  ...,  4.0501e-01,
         -1.9955e+00, -6.6770e-01]]), tensor([[-9.9326e+01,  2.1263e+00,  3.1131e+01,  ...,  3.3970e+01,
         -5.4622e+01,  8.2150e+00],
        [-9.4371e+02, -8.3552e+00,  3.0123e+02,  ...,  3.2287e+02,
         -5.0560e+02,  7.7524e+01],
        [-2.4615e+03,  7.5129e+00,  7.7539e+02,  ...,  8.5470e+02,
         -1.3425e+03,  2.1301e+02],
        ...,
        [-4.9126e+01,  4.8674e-01,  1.5568e+01,  ...,  1.5164e+01,
         -2.6284e+01,  1.6030e+00],
        [-3.0932e+02, -1.0051e+00,  9.7192e+01,  ...,  1.0505e+02,
         -1.6688e+02,  2.4839e+01],
        [-1.4586e+03,  2.7316e+00,  4.5913e+02,  ...,  5.0601e+02,
         -7.9422e+02,  1.2662e+02]]), tensor([[-3.0344e+02,  1.8325e+00,  9.5032e+01,  ...,  1.0318e+02,
         -1.6456e+02,  2.2854e+01],
        [-3.0047e+01, -3.6245e-01,  9.7663e+00,  ...,  9.2651e+00,
         -1.5801e+01,  6.6228e-01],
        [-2.3770e+02, -5.1053e+00,  7.7093e+01,  ...,  7.7718e+01,
         -1.2470e+02,  1.4487e+01],
        ...,
        [-9.2684e+01, -3.6484e-01,  2.9088e+01,  ...,  3.0454e+01,
         -4.9688e+01,  6.3048e+00],
        [-6.0070e+02,  2.6652e+00,  1.9004e+02,  ...,  2.0870e+02,
         -3.2787e+02,  5.2699e+01],
        [-7.2830e+02, -6.6742e+00,  2.3213e+02,  ...,  2.4865e+02,
         -3.9030e+02,  5.8331e+01]])]})
client_new_labels {}
configs.iid_clients
configs.iid_clients
configs.iid_clients
exp path: ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4
avgkd
Experiment in ./expt_dump/svhn/iid/iid_clients_avgkd_svhn_4clients_1000samples_10_algo_avgkd_seed_4_seed4 already present
Press e to exit, r to replace it: configs.iid_clients
avgkd
configs.iid_clients
avgkd
avgkd
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
['./__pycache__/', './.ipynb_checkpoints/', './imgs/', './expt_dump_old/', './expt_dump/', './expt_dump/svhn/iid/'] ['./utils/', './expt_dump/', './__pycache__/', './imgs/', './models/', './algos/', './configs/']
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
source code copied to exp_dump
avgkd
Using downloaded and verified file: ./imgs/svhn/train_32x32.mat
Model resnet18 loading on device cuda:3
Model resnet18 loading on device cuda:2
Model resnet18 loading on device cuda:0
Model resnet18 loading on device cuda:1
Model resnet18 loaded on device cuda:3
Model resnet18 loaded on device cuda:2
Model resnet18 loaded on device cuda:0
Using downloaded and verified file: ./imgs/svhn/test_32x32.mat
Model resnet18 loaded on device cuda:1
Model resnet18 loading on device cuda:0
Model resnet18 loaded on device cuda:0
Client 4 finished training with loss (14.409407138824463, 0.121)
Client 3 finished training with loss (19.571130752563477, 0.119)
Client 2 finished training with loss (18.154409885406494, 0.143)
Client 1 finished training with loss (17.91134524345398, 0.129)
Client 4 finished training with loss (14.621303081512451, 0.108)
Client 3 finished training with loss (22.781962871551514, 0.077)
Client 2 finished training with loss (20.738706588745117, 0.092)
Client 1 finished training with loss (15.402326583862305, 0.084)
Client 3 finished training with loss (16.47201943397522, 0.104)
Client 4 finished training with loss (13.492805004119873, 0.137)
Client 2 finished training with loss (13.31471586227417, 0.157)
Client 1 finished training with loss (11.88084864616394, 0.159)
Client 3 finished training with loss (12.106818199157715, 0.209)
Client 4 finished training with loss (11.172560691833496, 0.135)
Client 2 finished training with loss (10.909311532974243, 0.102)
Client 1 finished training with loss (10.47948145866394, 0.143)
Client 3 finished training with loss (11.066572189331055, 0.148)
Client 4 finished training with loss (10.3720543384552, 0.163)
Client 2 finished training with loss (9.852294206619263, 0.159)
Client 1 finished training with loss (9.862576007843018, 0.1)
1 44750336
client_node_1 1
2 44750336
3 91335680
client_node_2 2
4 91335680
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94186496
7 94186496
8 94196224
9 94186496
client_node_2 3
4 94186496
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94186496
7 94186496
8 94196224
9 94186496
client_node_2 4
4 94186496
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94481408
7 94481408
8 94491648
9 94481408
5 91335680
6 94186496
7 94186496
8 94196224
9 94186496
1 94186496
client_node_1 2
2 94186496
3 139854336
client_node_2 1
4 139854336
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 139854336
7 139854336
8 139864064
9 139854336
client_node_2 3
4 139854336
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 139854336
7 139854336
8 139864064
9 139854336
client_node_2 4
4 139854336
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 140149248
7 140149248
8 140159488
9 140149248
5 137003520
6 139854336
7 139854336
8 139864064
9 139854336
1 139854336
client_node_1 3
2 139854336
3 185030656
client_node_2 1
4 185030656
5 182179840
6 185325568
7 185325568
8 185335808
9 185325568
5 182179840
6 185325568
7 185325568
8 185335808
9 185325568
5 182179840
6 185325568
7 185325568
8 185335808
9 185325568
5 182179840
6 185030656
7 185030656
8 185040384
9 185030656
client_node_2 2
4 185030656
5 182179840
6 185325568
7 185325568
8 185335808
9 185325568
5 182179840
6 185325568
7 185325568
8 185335808
9 185325568
5 182179840
6 185325568
7 185325568
8 185335808
9 185325568
5 182179840
6 185030656
7 185030656
8 185040384
9 185030656
client_node_2 4
4 185030656
5 182179840
6 185325568
7 185325568
8 185335808
9 185325568
5 182179840
6 185325568
7 185325568
8 185335808
9 185325568
5 182179840
6 185325568
7 185325568
8 185335808
9 185325568
5 182179840
6 185030656
7 185030656
8 185040384
9 185030656
1 185030656
client_node_1 4
2 185030656
3 231747072
client_node_2 1
4 231747072
5 228896256
6 232041984
7 232041984
8 232052224
9 232041984
5 228896256
6 232041984
7 232041984
8 232052224
9 232041984
5 228896256
6 232041984
7 232041984
8 232052224
9 232041984
5 228896256
6 231747072
7 231747072
8 231756800
9 231747072
client_node_2 2
4 231747072
5 228896256
6 232041984
7 232041984
8 232052224
9 232041984
5 228896256
6 232041984
7 232041984
8 232052224
9 232041984
5 228896256
6 232041984
7 232041984
8 232052224
9 232041984
5 228896256
6 231747072
7 231747072
8 231756800
9 231747072
client_node_2 3
4 231747072
5 228896256
6 232041984
7 232041984
8 232052224
9 232041984
5 228896256
6 232041984
7 232041984
8 232052224
9 232041984
5 228896256
6 232041984
7 232041984
8 232052224
9 232041984
5 228896256
6 231747072
7 231747072
8 231756800
9 231747072
defaultdict(<class 'list'>, {1: [tensor([[0, 0, 0,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]]), tensor([[ 3.1115e+01, -2.0211e+01, -2.0613e+01,  ...,  2.1794e+01,
         -5.3409e+00, -2.1550e+01],
        [ 6.0432e-02,  6.7298e-01, -1.6034e-01,  ..., -1.7248e-01,
         -6.7221e-01, -4.7022e-01],
        [ 7.2480e+01, -4.5711e+01, -4.8362e+01,  ...,  5.1275e+01,
         -7.4091e+00, -5.0885e+01],
        ...,
        [ 1.2336e+01, -6.2757e+00, -8.6792e+00,  ...,  8.1798e+00,
         -4.1738e+00, -9.9419e+00],
        [ 4.3606e+00, -2.4579e+00, -2.9030e+00,  ...,  2.8521e+00,
         -1.5455e+00, -3.2023e+00],
        [ 4.4197e+01, -2.9184e+01, -2.9438e+01,  ...,  3.1131e+01,
         -6.9685e+00, -3.0327e+01]]), tensor([[ 6.0035e-01,  6.7778e-01, -6.2975e-01,  ..., -8.2347e-02,
         -1.2273e+00, -9.9506e-01],
        [-2.7434e-01,  1.2360e+00, -7.1434e-04,  ..., -5.6858e-01,
         -7.3806e-01, -4.3525e-01],
        [-8.4378e-02,  1.0287e+00,  4.4992e-02,  ..., -3.0761e-01,
         -2.7965e-01, -4.2898e-01],
        ...,
        [ 3.7243e+01, -2.4322e+01, -2.5623e+01,  ...,  2.5003e+01,
         -8.6188e+00, -2.5894e+01],
        [ 1.5393e+01, -9.4555e+00, -1.0390e+01,  ...,  1.0673e+01,
         -3.6994e+00, -1.1290e+01],
        [ 7.6230e+01, -4.9563e+01, -5.1167e+01,  ...,  5.3507e+01,
         -9.9274e+00, -5.2889e+01]]), tensor([[ 5.5174e-02,  8.3534e-01, -1.1323e-01,  ..., -2.3477e-01,
         -7.7477e-01, -4.7799e-01],
        [-4.0211e-02,  8.1679e-01, -1.0908e-01,  ..., -2.5376e-01,
         -6.3565e-01, -4.8752e-01],
        [ 6.1484e+00, -2.6449e+00, -4.6407e+00,  ...,  3.7097e+00,
         -2.5223e+00, -5.1247e+00],
        ...,
        [ 1.1158e+01, -6.4040e+00, -7.7313e+00,  ...,  7.0058e+00,
         -4.4150e+00, -8.1991e+00],
        [ 2.1703e+02, -1.4136e+02, -1.4602e+02,  ...,  1.5464e+02,
         -2.0385e+01, -1.4788e+02],
        [ 4.5049e+00, -2.2963e+00, -3.0384e+00,  ...,  2.8679e+00,
         -2.0092e+00, -3.7444e+00]]), tensor([[ 1.5303e+00, -3.5766e-01, -1.0950e+00,  ...,  8.5330e-01,
         -9.3170e-01, -1.5103e+00],
        [ 2.7421e+02, -1.8006e+02, -1.8336e+02,  ...,  1.9554e+02,
         -2.5920e+01, -1.8534e+02],
        [-1.1997e-01,  1.1226e+00,  3.3999e-02,  ..., -3.8112e-01,
         -3.3523e-01, -4.2694e-01],
        ...,
        [ 2.8127e+01, -1.7652e+01, -1.8782e+01,  ...,  1.9939e+01,
         -4.1454e+00, -1.9714e+01],
        [-2.3197e-01,  1.2291e+00,  2.1699e-02,  ..., -5.1315e-01,
         -4.7080e-01, -3.7768e-01],
        [ 3.2727e-01,  7.8002e-01, -3.3626e-01,  ..., -8.5717e-02,
         -9.3745e-01, -9.5506e-01]])], 2: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0]]), tensor([[ 1.1480e+02, -7.5553e+01, -7.7617e+01,  ...,  7.9783e+01,
         -1.8474e+01, -7.9276e+01],
        [ 3.4318e-01,  7.2366e-01, -4.0158e-01,  ..., -3.6792e-02,
         -8.2910e-01, -9.7251e-01],
        [ 2.0674e+02, -1.3664e+02, -1.3724e+02,  ...,  1.4780e+02,
         -2.1139e+01, -1.3903e+02],
        ...,
        [ 2.3127e+01, -1.5091e+01, -1.5393e+01,  ...,  1.6100e+01,
         -4.1668e+00, -1.5900e+01],
        [ 1.5347e+01, -9.1205e+00, -1.0612e+01,  ...,  9.8167e+00,
         -4.8523e+00, -1.1237e+01],
        [-7.3987e-02,  9.8114e-01,  6.4091e-02,  ..., -2.6533e-01,
         -2.5292e-01, -4.3971e-01]]), tensor([[ 1.2209e+01, -6.7639e+00, -8.2151e+00,  ...,  8.6548e+00,
         -1.5452e+00, -9.2095e+00],
        [ 1.2178e+02, -7.9339e+01, -8.1408e+01,  ...,  8.6388e+01,
         -1.1830e+01, -8.2254e+01],
        [ 1.3417e+02, -8.7114e+01, -9.0401e+01,  ...,  9.5834e+01,
         -1.2397e+01, -9.1053e+01],
        ...,
        [ 3.5156e+02, -2.2973e+02, -2.3623e+02,  ...,  2.5035e+02,
         -3.3022e+01, -2.3837e+02],
        [-7.0011e-02,  1.0064e+00,  4.2981e-02,  ..., -2.8198e-01,
         -2.6263e-01, -4.3188e-01],
        [ 1.8742e+01, -1.2011e+01, -1.2434e+01,  ...,  1.3094e+01,
         -3.4669e+00, -1.3057e+01]]), tensor([[ 1.4779e+02, -9.4676e+01, -9.9756e+01,  ...,  1.0425e+02,
         -1.5125e+01, -1.0153e+02],
        [-1.7351e-01,  1.0644e+00, -7.9941e-02,  ..., -4.3315e-01,
         -6.4954e-01, -3.7641e-01],
        [ 1.3196e+02, -8.6268e+01, -8.8194e+01,  ...,  9.3902e+01,
         -1.3953e+01, -8.9142e+01],
        ...,
        [-2.3178e-01,  1.0839e+00,  7.9780e-03,  ..., -4.5850e-01,
         -5.3304e-01, -3.8514e-01],
        [ 7.2695e+00, -4.3005e+00, -4.8794e+00,  ...,  4.9514e+00,
         -1.9516e+00, -5.2698e+00],
        [ 2.6954e+01, -1.7322e+01, -1.7861e+01,  ...,  1.9100e+01,
         -3.9932e+00, -1.8551e+01]]), tensor([[ 3.9678e+02, -2.5619e+02, -2.6690e+02,  ...,  2.8310e+02,
         -3.3867e+01, -2.7119e+02],
        [ 3.4060e+01, -2.1593e+01, -2.2908e+01,  ...,  2.3709e+01,
         -6.3124e+00, -2.4423e+01],
        [ 2.4723e+00,  2.7332e-01, -2.5134e+00,  ...,  1.1152e+00,
         -2.1901e+00, -2.7030e+00],
        ...,
        [ 3.8905e+00, -1.9079e+00, -2.6504e+00,  ...,  2.5058e+00,
         -1.7263e+00, -3.1902e+00],
        [-1.8736e-01,  1.2174e+00, -1.8247e-02,  ..., -4.1729e-01,
         -4.1811e-01, -4.3330e-01],
        [-2.4787e-01,  1.1700e+00,  2.0689e-03,  ..., -4.7151e-01,
         -5.8001e-01, -4.1918e-01]])], 3: [tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0]]), tensor([[ 2.6135e+01, -1.6878e+01, -1.7472e+01,  ...,  1.8219e+01,
         -4.7617e+00, -1.8782e+01],
        [-2.2489e-01,  1.1656e+00,  3.4957e-03,  ..., -4.7651e-01,
         -5.8157e-01, -3.8198e-01],
        [ 1.4945e+01, -8.8360e+00, -1.0141e+01,  ...,  9.8473e+00,
         -4.5127e+00, -1.1366e+01],
        ...,
        [ 1.8038e+01, -1.1828e+01, -1.1686e+01,  ...,  1.2565e+01,
         -3.6834e+00, -1.2540e+01],
        [-1.7624e-01,  1.3861e+00, -1.0835e-01,  ..., -6.3443e-01,
         -9.9761e-01, -4.8512e-01],
        [ 2.8839e+01, -1.7526e+01, -1.8750e+01,  ...,  1.9517e+01,
         -6.9833e+00, -2.1168e+01]]), tensor([[ 3.7833e+02, -2.4823e+02, -2.5471e+02,  ...,  2.6947e+02,
         -3.6345e+01, -2.5616e+02],
        [ 2.4046e+02, -1.5921e+02, -1.6103e+02,  ...,  1.7125e+02,
         -2.5399e+01, -1.6177e+02],
        [ 2.2887e+01, -1.3797e+01, -1.5452e+01,  ...,  1.6110e+01,
         -3.6188e+00, -1.6882e+01],
        ...,
        [-1.8517e-01,  1.2108e+00,  3.4628e-02,  ..., -4.5764e-01,
         -4.0443e-01, -4.2858e-01],
        [ 7.4702e+00, -3.9400e+00, -4.8502e+00,  ...,  5.1725e+00,
         -1.4530e+00, -5.9464e+00],
        [-4.8365e-02,  9.1502e-01,  4.4227e-02,  ..., -2.4032e-01,
         -2.4010e-01, -4.0376e-01]]), tensor([[-2.0154e-01,  1.1808e+00,  4.2842e-02,  ..., -4.3830e-01,
         -3.9374e-01, -4.0644e-01],
        [ 1.1027e+01, -6.9904e+00, -7.1857e+00,  ...,  7.4888e+00,
         -2.8446e+00, -7.7434e+00],
        [ 3.8336e+01, -2.4427e+01, -2.5416e+01,  ...,  2.7175e+01,
         -5.2363e+00, -2.6795e+01],
        ...,
        [-2.0718e-01,  1.2302e+00,  7.5296e-05,  ..., -4.9017e-01,
         -4.9020e-01, -3.8453e-01],
        [ 3.0355e+00, -1.0177e+00, -2.2591e+00,  ...,  1.6456e+00,
         -2.0906e+00, -2.8273e+00],
        [ 2.3929e+02, -1.5372e+02, -1.6076e+02,  ...,  1.7158e+02,
         -1.9514e+01, -1.6303e+02]]), tensor([[ 344.8549, -222.3082, -232.0743,  ...,  246.2621,  -29.1502,
         -235.3479],
        [ 152.3796,  -94.9769, -101.6745,  ...,  109.4647,   -9.6629,
         -105.5803],
        [ 159.1837, -105.4992, -106.7386,  ...,  113.0183,  -17.3168,
         -107.5123],
        ...,
        [   3.0083,   -1.0612,   -2.1431,  ...,    1.7774,   -1.5513,
           -2.7561],
        [ 132.1531,  -86.7981,  -87.6767,  ...,   94.3003,  -14.1824,
          -89.2414],
        [   7.4315,   -4.5086,   -4.9788,  ...,    5.0685,   -2.1096,
           -5.3978]])]})
client_new_labels {}
